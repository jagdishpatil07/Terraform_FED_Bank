Install AWS CLI:-
- configure aws cli
Install terraform:-
- create project 
  -  mkdir fedbank-infra
  -  cd fedbank-infra
  - Git clone URL

terraform validate
terraform plan
terraform apply -auto-approve



--------------------------------------------

# FEDBank - Terraform (UAT + PROD + TGW + VPN + EC2) - Runbook

Diagram: /mnt/data/722541f7-fd84-41e2-b606-983c96cb2b13.png

## Files
- provider.tf
- variables.tf
- main.tf
- outputs.tf
- terraform.tfvars.example

## Before you start
1. Install Terraform & AWS CLI.
2. Create an AWS IAM user with privileges: VPC, EC2, IAM, Transit Gateway, VPN, EC2:RunInstances, SSM.
3. Configure AWS CLI: `aws configure`.

## Steps to deploy
1. Copy `terraform.tfvars.example` to `terraform.tfvars` and fill blanks (AMIs, CIDRs, region, client GW IP).
2. Initialize:

3. Validate:

4. Plan:

5. Apply:

----------------------------------
RESOURCES:-
--------------
ğŸ“Œ TOTAL RESOURCE COUNT

Your client AWS account will get:

âœ” 2 VPCs
âœ” 4 Subnets
âœ” 2 Route Tables
âœ” 4 RT Associations
âœ” 2 Routes to TGW
âœ” 1 Transit Gateway
âœ” 2 VPC TGW Attachments
âœ” 1 TGW Route Table
âœ” 3 TGW routes
âœ” 1 Customer Gateway
âœ” 1 VPN Connection
âœ” 6 VPC Interface Endpoints
âœ” 1 IAM Role
âœ” 1 IAM Policy Attachment
âœ” 1 IAM Instance Profile
âœ” 4 EC2 Instances

-----------------------

ğŸ— 1. VPC Infrastructure
UAT VPC

VPC â€” aws_vpc.uat

Subnets

aws_subnet.uat_app

aws_subnet.uat_db

Route Table â€” aws_route_table.uat_priv_rt

Route Table Associations

aws_route_table_association.uat_app_assoc

aws_route_table_association.uat_db_assoc

Route to TGW

aws_route.uat_to_tgw_client

PROD VPC

VPC â€” aws_vpc.prod

Subnets

aws_subnet.prod_app

aws_subnet.prod_db

Route Table â€” aws_route_table.prod_priv_rt

Route Table Associations

aws_route_table_association.prod_app_assoc

aws_route_table_association.prod_db_assoc

Route to TGW

aws_route.prod_to_tgw_client

ğŸ”— 2. Transit Gateway + Attachments

Your script creates the full TGW infra:

Transit Gateway â€” aws_ec2_transit_gateway.tgw

TGW VPC Attachments

aws_ec2_transit_gateway_vpc_attachment.uat_attach

aws_ec2_transit_gateway_vpc_attachment.prod_attach

ğŸ›£ 3. TGW Routing

TGW Route Table â€” aws_ec2_transit_gateway_route_table.tgw_rt

Routes inside TGW

aws_ec2_transit_gateway_route.tgw_to_uat

aws_ec2_transit_gateway_route.tgw_to_prod

aws_ec2_transit_gateway_route.to_client

ğŸ” 4. Customer VPN Resources

The script creates:

Customer Gateway â€” aws_customer_gateway.client_cgw

VPN Connection â€” aws_vpn_connection.tgw_vpn

ğŸ”‘ 5. IAM Resources

These are required for EC2 â†’ SSM connection:

IAM Role â€” aws_iam_role.ec2_ssm_role

IAM Policy Attachment â€” aws_iam_role_policy_attachment.ssm_attach

Instance Profile â€” aws_iam_instance_profile.ec2_ssm_profile

ğŸ–§ 6. VPC Interface Endpoints (SSM)

These create ENIs in private subnets:

UAT

aws_vpc_endpoint.ssm_ua

aws_vpc_endpoint.ec2msg_ua

aws_vpc_endpoint.ssmmessages_ua

PROD

aws_vpc_endpoint.ssm_prod

aws_vpc_endpoint.ec2msg_prod

aws_vpc_endpoint.ssmmessages_prod

ğŸ’» 7. EC2 Instances

(Your posted snippet references them; assume they exist later in file)

aws_instance.uat_app

aws_instance.uat_db

aws_instance.prod_app

aws_instance.prod_db
